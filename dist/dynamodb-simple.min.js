var dynamodbSimple=function(){"use strict";function e(e,t,o,n){a.config.update({accessKeyId:e,secretAccessKey:t,region:o}),T=new a.DynamoDB.DocumentClient({endpoint:n})}function t(){return T}function o(e,t){switch(e){case"NUMBER":return parseFloat(t);case"BOOLEAN":if("null"===t)return null;if("true"===t)return!0;if("false"===t)return!1;default:return t}}function n(e){return e.replace(/-/g,"").replace(/\./g,"").replace(/@/g,"")}function r(e){return"function"!=typeof e&&(e=i),e}function i(){}function s(e,t,r,i){var s="",u={},c={},p={FilterExpression:(e=f.tokenize(e).reduce(function(e,p){if("LITERAL"!==p[0]||m.includes(p[1]))if("NUMBER"===p[0]||"DBLSTRING"===p[0]||"STRING"===p[0]||"BOOLEAN"===p[0]){var k=n(p[1]);c[":"+k]=o(p[0],p[1]),e+=" :"+k}else e+=" "+p[1];else i&&t&&p[1]===t?s+=" #"+p[1]:i&&r&&p[1]===r?s+=", #"+p[1]:e+=" #"+p[1],u["#"+p[1]]=p[1];return e},"")).trim(),ExpressionAttributeNames:u,ExpressionAttributeValues:c};return i&&(p.KeyConditionExpression=s),p}function u(e,t,o){return function(n,r){void 0===r&&(r=i),db.query(Object.assign({TableName:e},s(n,t,o,!0)),r)}}function c(e,o,n){var i=arguments;return function(s,u){var c={};c[o]=s,n&&void 0!==u&&(c[n]=u),t().get({TableName:e,Key:c},r(i[i.length-1]))}}function p(e){return function(t,o){void 0===o&&(o=i),db.put({TableName:e,Item:t},o)}}function k(e,t,o){return function(n,i,u,c){c="function"==typeof u?u:c;var p={};p[t]=i,o&&void 0!==u&&(p[o]=u);var k,h=(k=s(n),UpdateExpression=k.FilterExpression,ExpressionAttributeNames=k.ExpressionAttributeNames,ExpressionAttributeValues=k.ExpressionAttributeValues,k);db.update(Object.assign({TableName:e,Key:p},h),r(c))}}function h(e,t,o){var n=arguments;return function(i,s,u){var c={};c[t]=s,o&&void 0!==u&&(c[o]=u),db.delete({TableName:e,Key:c},r(n[n.length-1]))}}var a=require("aws-sdk"),T=void 0,d=function(){function e(e,t){var o,n,r=this;for(null==t&&(t={}),this.sql=e,this.preserveWhitespace=t.preserveWhitespace||!1,this.tokens=[],this.currentLine=1,n=0;this.chunk=e.slice(n);){if((o=r.keywordToken()||r.starToken()||r.booleanToken()||r.functionToken()||r.windowExtension()||r.sortOrderToken()||r.seperatorToken()||r.operatorToken()||r.mathToken()||r.dotToken()||r.conditionalToken()||r.subSelectOpToken()||r.subSelectUnaryOpToken()||r.numberToken()||r.stringToken()||r.parameterToken()||r.parensToken()||r.whitespaceToken()||r.literalToken())<1)throw new Error("NOTHING CONSUMED: Stopped at - '"+r.chunk.slice(0,30)+"'");n+=o}this.token("EOF",""),this.postProcess()}var t,o,n,r,i,s,u,c,p,k,h,a,T,d,f,m,l;return e.prototype.postProcess=function(){var e,t,o,n,r,i,s,u=this;for(s=[],e=n=0,r=(i=this.tokens).length;n<r;e=++n)"STAR"===(o=i[e])[0]&&"SEPARATOR"!==(t=u.tokens[e+1])[0]&&"FROM"!==t[0]?s.push(o[0]="MATH_MULTI"):s.push(void 0);return s},e.prototype.token=function(e,t){return this.tokens.push([e,t,this.currentLine])},e.prototype.tokenizeFromRegex=function(e,t,o,n,r){var i,s;return null==o&&(o=0),null==n&&(n=o),null==r&&(r=!0),(i=t.exec(this.chunk))?(s=i[o],r&&this.token(e,s),i[n].length):0},e.prototype.tokenizeFromWord=function(e,t){var o,n;return null==t&&(t=e),t=this.regexEscape(t),n=/^\w+$/.test(t)?new RegExp("^("+t+")\\b","ig"):new RegExp("^("+t+")","ig"),(o=n.exec(this.chunk))?(this.token(e,o[1]),o[1].length):0},e.prototype.tokenizeFromList=function(e,t){var o,n,r,i,s=this;for(n=0,r=0,i=t.length;r<i&&(o=t[r],!((n=s.tokenizeFromWord(e,o))>0));r++);return n},e.prototype.keywordToken=function(){return this.tokenizeFromWord("SELECT")||this.tokenizeFromWord("DISTINCT")||this.tokenizeFromWord("FROM")||this.tokenizeFromWord("WHERE")||this.tokenizeFromWord("GROUP")||this.tokenizeFromWord("ORDER")||this.tokenizeFromWord("BY")||this.tokenizeFromWord("HAVING")||this.tokenizeFromWord("LIMIT")||this.tokenizeFromWord("JOIN")||this.tokenizeFromWord("LEFT")||this.tokenizeFromWord("RIGHT")||this.tokenizeFromWord("INNER")||this.tokenizeFromWord("OUTER")||this.tokenizeFromWord("ON")||this.tokenizeFromWord("AS")||this.tokenizeFromWord("UNION")||this.tokenizeFromWord("ALL")||this.tokenizeFromWord("LIMIT")||this.tokenizeFromWord("OFFSET")||this.tokenizeFromWord("FETCH")||this.tokenizeFromWord("ROW")||this.tokenizeFromWord("ROWS")||this.tokenizeFromWord("ONLY")||this.tokenizeFromWord("NEXT")||this.tokenizeFromWord("FIRST")},e.prototype.dotToken=function(){return this.tokenizeFromWord("DOT",".")},e.prototype.operatorToken=function(){return this.tokenizeFromList("OPERATOR",h)},e.prototype.mathToken=function(){return this.tokenizeFromList("MATH",r)||this.tokenizeFromList("MATH_MULTI",i)},e.prototype.conditionalToken=function(){return this.tokenizeFromList("CONDITIONAL",p)},e.prototype.subSelectOpToken=function(){return this.tokenizeFromList("SUB_SELECT_OP",f)},e.prototype.subSelectUnaryOpToken=function(){return this.tokenizeFromList("SUB_SELECT_UNARY_OP",m)},e.prototype.functionToken=function(){return this.tokenizeFromList("FUNCTION",k)},e.prototype.sortOrderToken=function(){return this.tokenizeFromList("DIRECTION",a)},e.prototype.booleanToken=function(){return this.tokenizeFromList("BOOLEAN",t)},e.prototype.starToken=function(){return this.tokenizeFromRegex("STAR",T)},e.prototype.seperatorToken=function(){return this.tokenizeFromRegex("SEPARATOR",c)},e.prototype.literalToken=function(){return this.tokenizeFromRegex("LITERAL",n,1,0)},e.prototype.numberToken=function(){return this.tokenizeFromRegex("NUMBER",s)},e.prototype.parameterToken=function(){return this.tokenizeFromRegex("PARAMETER",u)},e.prototype.stringToken=function(){return this.tokenizeFromRegex("STRING",d,1,0)||this.tokenizeFromRegex("DBLSTRING",o,1,0)},e.prototype.parensToken=function(){return this.tokenizeFromRegex("LEFT_PAREN",/^\(/)||this.tokenizeFromRegex("RIGHT_PAREN",/^\)/)},e.prototype.windowExtension=function(){var e;return(e=/^\.(win):(length|time)/i.exec(this.chunk))?(this.token("WINDOW",e[1]),this.token("WINDOW_FUNCTION",e[2]),e[0].length):0},e.prototype.whitespaceToken=function(){var e,t,o;return(e=l.exec(this.chunk))?(o=e[0],t=o.replace(/[^\n]/,"").length,this.currentLine+=t,this.preserveWhitespace&&this.token(name,o),o.length):0},e.prototype.regexEscape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},k=["AVG","COUNT","MIN","MAX","SUM"],a=["ASC","DESC"],h=["=","!=",">=",">","<=","<>","<","LIKE","IS NOT","IS"],f=["IN","NOT IN","ANY","ALL","SOME"],m=["EXISTS"],p=["AND","OR"],t=["TRUE","FALSE","NULL"],r=["+","-"],i=["/","*"],T=/^\*/,c=/^,/,l=/^[ \n\r]+/,n=/^`?([a-z_][a-z0-9_]{0,})`?/i,u=/^\$[0-9]+/,s=/^[0-9]+(\.[0-9]+)?/,d=/^'([^\\']*(?:\\.[^\\']*)*)'/,o=/^"([^\\"]*(?:\\.[^\\"]*)*)"/,e}(),f=function(e,t){return new d(e,t).tokens},m=["SET","AND","OR","ADD"],l=Object.freeze({default:function(e,t,o){return{scan:scann(e),query:u(e,t,o),get:c(e,t,o),put:p(e),update:k(e,t,o),del:h(e,t,o)}},scan:function(e){return function(e,t){void 0===t&&(t=i),db.scan(Object.assign(obj,s(e)),t)}},query:u,get:c,put:p,update:k,del:h});return function(t){return void 0===t&&(t={}),e(t.accessKey||"cUniqueSessionID",t.secret||"SECRET",t.region||"us-west-2",t.endpoint||"http://localhost:8000"),l}}();
//# sourceMappingURL=dynamodb-simple.min.js.map
